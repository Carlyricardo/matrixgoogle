<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Matrix Search Engine</title>
<style>
body {
  margin: 0;
  height: 100vh;
  background: black;
  color: #00ff00;
  font-family: 'Courier New', monospace;
  overflow-x: hidden;
}
canvas {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;
}
.search-section, .results-section {
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  padding: 20px;
  box-sizing: border-box;
}
.search-container {
  width: 80%;
  max-width: 600px;
  text-align: center;
}
.search-box {
  width: 100%;
  padding: 15px;
  font-size: 16px;
  background-color: rgba(0, 0, 0, 0.8);
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 24px;
  outline: none;
  margin-bottom: 20px;
}
.search-btn {
  padding: 10px 20px;
  background-color: rgba(0, 255, 0, 0.2);
  color: #00ff00;
  border: 1px solid #00ff00;
  border-radius: 4px;
  cursor: pointer;
  margin: 0 5px;
}
.search-btn:hover {
  background-color: rgba(0, 255, 0, 0.4);
}
.terminal {
  background: rgba(0, 0, 0, 0.8);
  border: 1px solid #00ff00;
  padding: 10px;
  width: 80%;
  max-width: 800px;
  height: 200px;
  overflow-y: auto;
  margin-top: 20px;
  font-size: 14px;
}
.cursor {
  display: inline-block;
  width: 10px;
  background: #00ff00;
  animation: blink 1s infinite;
}
@keyframes blink {
  0%, 50% { background: #00ff00; }
  51%, 100% { background: transparent; }
}
.progress-bar {
  width: 80%;
  max-width: 600px;
  height: 20px;
  border: 1px solid #00ff00;
  margin-top: 10px;
  position: relative;
  overflow: hidden;
  display: none;
}
.progress-fill {
  background: #00ff00;
  width: 0%;
  height: 100%;
  transition: width 0.2s;
}
.results-section {
  display: none;
  flex-direction: column;
  align-items: center;
}
.back-button {
  margin: 20px;
  padding: 10px 20px;
  border: 1px solid #00ff00;
  background: black;
  color: #00ff00;
  cursor: pointer;
}
.back-button:hover {
  background: #00ff00;
  color: black;
}
.results-container {
  width: 90%;
  max-width: 800px;
  margin: 20px 0;
}
.api-config {
  margin-top: 20px;
  padding: 15px;
  background: rgba(0, 0, 0, 0.8);
  border: 1px solid #00ff00;
  border-radius: 8px;
  width: 80%;
  max-width: 600px;
  text-align: left;
}
.api-config h3 {
  margin-top: 0;
  color: #00ff00;
}
.api-config p {
  color: #00cc00;
  font-size: 14px;
  margin: 5px 0;
}
.api-config a {
  color: #00ff00;
}
</style>
</head>
<body>

<canvas id="matrix-canvas"></canvas>

<div class="search-section" id="search-section">
  <div class="search-container">
    <h1>MATRIX SEARCH</h1>
    <input type="text" class="search-box" placeholder="Enter your search query" id="search-input">
    <div>
      <button class="search-btn" id="google-search">Search</button>
      <button class="search-btn" id="lucky-search">I'm Feeling Lucky</button>
    </div>
    <div class="terminal" id="terminal">
      <div id="terminal-text">&gt; Initializing Matrix Search Engine<span class="cursor"></span></div>
    </div>
    <div class="progress-bar" id="progress-bar">
      <div class="progress-fill" id="progress-fill"></div>
    </div>
    
    <div class="api-config">
      <h3>Custom Search Engine Active</h3>
      <p>CX ID: 874a211f8789d4055</p>
      <p>Public URL: <a href="https://cse.google.com/cse?cx=874a211f8789d4055" target="_blank">View Search Engine</a></p>
    </div>
  </div>
</div>

<div class="results-section" id="results-section">
  <h2>Search Results</h2>
  <div class="results-container" id="results-container">
    <div class="gcse-searchresults-only"></div>
  </div>
  <button class="back-button" id="back-to-search">Back to Search</button>
</div>

<!-- Google CSE script -->
<script async src="https://cse.google.com/cse.js?cx=874a211f8789d4055"></script>

<script>
// === MATRIX RAIN ===
const canvas = document.getElementById('matrix-canvas');
const ctx = canvas.getContext('2d');
function resizeCanvas() {
  canvas.height = window.innerHeight;
  canvas.width = window.innerWidth;
}
resizeCanvas();
const letters = '01';
const fontSize = 16;
let columns = canvas.width / fontSize;
let drops = Array(Math.floor(columns)).fill(1);
function draw() {
  ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = '#0F0';
  ctx.font = fontSize + 'px monospace';
  for (let i = 0; i < drops.length; i++) {
    const text = letters.charAt(Math.floor(Math.random() * letters.length));
    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
    drops[i]++;
  }
}
setInterval(draw, 33);

// === SEARCH HANDLING ===
const searchInput = document.getElementById('search-input');
const googleSearchBtn = document.getElementById('google-search');
const luckySearchBtn = document.getElementById('lucky-search');
const searchSection = document.getElementById('search-section');
const resultsSection = document.getElementById('results-section');
const terminalText = document.getElementById('terminal-text');
const progressBar = document.getElementById('progress-bar');
const progressFill = document.getElementById('progress-fill');

function addTerminalText(text) {
  const newLine = document.createElement('div');
  newLine.innerHTML = text;
  terminalText.appendChild(newLine);
  terminalText.scrollTop = terminalText.scrollHeight;
}

function performSearch(isLucky = false) {
  const query = searchInput.value.trim();
  if (!query) {
    addTerminalText(`> Error: Please enter a search query.<span class="cursor"></span>`);
    return;
  }
  
  addTerminalText(`> Processing query: "${query}"`);
  
  if (isLucky) {
    window.open(`https://www.google.com/search?q=${encodeURIComponent(query)}&btnI=1`, '_blank');
    addTerminalText(`> Lucky search triggered for "${query}"`);
  } else {
    showSearchResults(query);
  }
}

function showSearchResults(query) {
  searchSection.style.display = "none";
  resultsSection.style.display = "flex";
  addTerminalText(`> Search results loaded for: "${query}"<span class='cursor'></span>`);

  // Trigger Google CSE search
  if (window.google && window.google.search && window.google.search.cse && window.google.search.cse.element) {
    const element = window.google.search.cse.element.getElement('searchresults-only0');
    if (element) element.execute(query);
  }
}

function goBackToSearch() {
  searchSection.style.display = "flex";
  resultsSection.style.display = "none";
  searchInput.value = '';
  searchInput.focus();
}

searchInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') performSearch(); });
googleSearchBtn.addEventListener('click', () => performSearch(false));
luckySearchBtn.addEventListener('click', () => performSearch(true));
document.getElementById('back-to-search').addEventListener('click', goBackToSearch);
window.addEventListener('resize', resizeCanvas);

// Initial terminal messages
setTimeout(() => { addTerminalText('> Connecting to Matrix network...'); }, 1000);
setTimeout(() => { addTerminalText('> Establishing secure connection to search servers...'); }, 2000);
setTimeout(() => { addTerminalText('> Firewall bypassed. Encryption active.'); }, 3000);
setTimeout(() => { addTerminalText('> Custom Search Engine integration complete.'); }, 4000);
setTimeout(() => { addTerminalText('> Ready for search queries.<span class="cursor"></span>'); }, 5000);
searchInput.focus();
</script>
</body>
</html>
